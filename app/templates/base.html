<!DOCTYPE html>
<html lang="pt-BR" x-data="themeManager" :class="{ 'dark': isDark }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>{% block title %}Bíblia Self-Hosted - Busca Bíblica Terminal{% endblock %}</title>
    <meta name="description" content="{% block description %}Sistema self-hosted para busca e estudo bíblico com interface terminal. Suporte a referências, busca semântica e múltiplas versões da Bíblia.{% endblock %}">
    <meta name="keywords" content="{% block keywords %}bíblia, busca bíblica, self-hosted, terminal, versículos, estudo bíblico, API bíblica, João 3:16, pesquisa bíblica{% endblock %}">
    <meta name="author" content="Filipe Lopes">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="{% block canonical %}https://biblia.filipelopes.me/{% endblock %}">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{% block og_url %}https://biblia.filipelopes.me/{% endblock %}">
    <meta property="og:title" content="{% block og_title %}Bíblia Self-Hosted - Busca Bíblica Terminal{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Sistema self-hosted para busca e estudo bíblico com interface terminal. Suporte a referências, busca semântica e múltiplas versões da Bíblia.{% endblock %}">
    <meta property="og:image" content="{% block og_image %}https://biblia.filipelopes.me/static/og-image.jpg{% endblock %}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="pt_BR">
    <meta property="og:site_name" content="Bíblia Self-Hosted">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="{% block twitter_url %}https://biblia.filipelopes.me/{% endblock %}">
    <meta name="twitter:title" content="{% block twitter_title %}Bíblia Self-Hosted - Busca Bíblica Terminal{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}Sistema self-hosted para busca e estudo bíblico com interface terminal. Suporte a referências, busca semântica e múltiplas versões da Bíblia.{% endblock %}">
    <meta name="twitter:image" content="{% block twitter_image %}https://biblia.filipelopes.me/static/og-image.jpg{% endblock %}">
    
    <!-- Favicon and App Icons -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="/static/site.webmanifest">
    <meta name="theme-color" content="#10b981">
    <meta name="msapplication-TileColor" content="#10b981">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Bíblia Self-Hosted",
        "description": "Sistema self-hosted para busca e estudo bíblico com interface terminal",
        "url": "https://biblia.filipelopes.me/",
        "applicationCategory": "EducationalApplication",
        "operatingSystem": "All",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "BRL"
        },
        "author": {
            "@type": "Person",
            "name": "Filipe Lopes"
        },
        "publisher": {
            "@type": "Person",
            "name": "Filipe Lopes"
        },
        "potentialAction": {
            "@type": "SearchAction",
            "target": {
                "@type": "EntryPoint",
                "urlTemplate": "https://biblia.filipelopes.me/?q={search_term_string}"
            },
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <!-- Tailwind CSS configuration -->
    <script>
        // Configure Tailwind before loading it
        window.tailwind = {
            config: {
                darkMode: 'class',
                theme: {
                    extend: {
                        fontFamily: {
                            'mono': ['Fira Code', 'Courier New', 'monospace'],
                        },
                        animation: {
                            'cursor-blink': 'cursor-blink 1s infinite',
                        },
                        keyframes: {
                            'cursor-blink': {
                                '0%, 50%': { opacity: '1' },
                                '51%, 100%': { opacity: '0' },
                            }
                        }
                    }
                }
            }
        };
    </script>
    
    <!-- Tailwind CSS - synchronous loading for critical styles -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Alpine.js with defer for better performance -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Preconnect to external domains for better performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    
    <!-- Google Fonts with display=swap for performance -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* Critical CSS - loads immediately for better UX */
        [x-cloak] { display: none !important; }
        
        /* Prevent FOUC (Flash of Unstyled Content) */
        body {
            font-family: 'Fira Code', 'Courier New', monospace;
            background-color: #f3f4f6;
            color: #111827;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            transition: all 0.3s ease;
        }
        
        /* Dark mode styles */
        html.dark body {
            background-color: #0c0c0c;
            color: #10b981;
        }
        
        /* Loading state to prevent layout shift */
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        /* Terminal cursor effect */
        .terminal-cursor::after {
            content: '_';
            animation: cursor-blink 1s infinite;
        }
        
        @keyframes cursor-blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* Custom scrollbar - fallback for when Tailwind loads */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background-color: #1f2937;
        }
        
        ::-webkit-scrollbar-thumb {
            background-color: #10b981;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background-color: #059669;
        }
        
        /* Light mode scrollbar */
        html:not(.dark) ::-webkit-scrollbar-track {
            background-color: #f3f4f6;
        }
        
        html:not(.dark) ::-webkit-scrollbar-thumb {
            background-color: #4b5563;
        }
        
        html:not(.dark) ::-webkit-scrollbar-thumb:hover {
            background-color: #374151;
        }
        
        /* Force dark mode precedence over media queries */
        html.dark body {
            background-color: #0c0c0c !important;
            color: #10b981 !important;
        }
        
        /* Override all Tailwind dark mode classes when html.dark is present */
        html.dark .dark\:bg-gray-950 {
            --tw-bg-opacity: 1 !important;
            background-color: rgb(3 7 18 / var(--tw-bg-opacity, 1)) !important;
        }
        
        html.dark .dark\:bg-gray-900 {
            --tw-bg-opacity: 1 !important;
            background-color: rgb(17 24 39 / var(--tw-bg-opacity, 1)) !important;
        }
        
        html.dark .dark\:bg-white {
            --tw-bg-opacity: 1 !important;
            background-color: rgb(17 24 39 / var(--tw-bg-opacity, 1)) !important;
        }
        
        html.dark .dark\:bg-gray-50 {
            --tw-bg-opacity: 1 !important;
            background-color: rgb(3 7 18 / var(--tw-bg-opacity, 1)) !important;
        }
        
        html.dark .dark\:text-green-400 {
            --tw-text-opacity: 1 !important;
            color: rgb(74 222 128 / var(--tw-text-opacity, 1)) !important;
        }
        
        html.dark .dark\:text-gray-400 {
            --tw-text-opacity: 1 !important;
            color: rgb(156 163 175 / var(--tw-text-opacity, 1)) !important;
        }
        
        html.dark .dark\:border-gray-800 {
            --tw-border-opacity: 1 !important;
            border-color: rgb(31 41 55 / var(--tw-border-opacity, 1)) !important;
        }
        
        /* Ensure light mode takes precedence when dark class is NOT present */
        html:not(.dark) body {
            background-color: #f3f4f6 !important;
            color: #111827 !important;
        }
        
        html:not(.dark) .bg-gray-100 {
            --tw-bg-opacity: 1 !important;
            background-color: rgb(243 244 246 / var(--tw-bg-opacity, 1)) !important;
        }
        
        html:not(.dark) .bg-white {
            --tw-bg-opacity: 1 !important;
            background-color: rgb(255 255 255 / var(--tw-bg-opacity, 1)) !important;
        }
        
        /* Override Tailwind's prefers-color-scheme media queries completely */
        @media (prefers-color-scheme: dark) {
            html:not(.dark) .dark\:bg-gray-900 {
                --tw-bg-opacity: 1 !important;
                background-color: rgb(255 255 255 / var(--tw-bg-opacity, 1)) !important;
            }
            
            html:not(.dark) .dark\:bg-gray-950 {
                --tw-bg-opacity: 1 !important;
                background-color: rgb(243 244 246 / var(--tw-bg-opacity, 1)) !important;
            }
            
            html:not(.dark) .dark\:text-green-400 {
                --tw-text-opacity: 1 !important;
                color: rgb(17 24 39 / var(--tw-text-opacity, 1)) !important;
            }
            
            html:not(.dark) .dark\:text-gray-400 {
                --tw-text-opacity: 1 !important;
                color: rgb(107 114 128 / var(--tw-text-opacity, 1)) !important;
            }
            
            html:not(.dark) .dark\:border-gray-800 {
                --tw-border-opacity: 1 !important;
                border-color: rgb(209 213 219 / var(--tw-border-opacity, 1)) !important;
            }
            
            /* Fix hover states for buttons in light mode */
            html:not(.dark) .dark\:hover\:bg-gray-800:hover {
                --tw-bg-opacity: 1 !important;
                background-color: rgb(229 231 235 / var(--tw-bg-opacity, 1)) !important;
            }
            
            html:not(.dark) .dark\:hover\:bg-gray-200:hover {
                --tw-bg-opacity: 1 !important;
                background-color: rgb(229 231 235 / var(--tw-bg-opacity, 1)) !important;
            }

            html:not(.dark) .dark\:text-gray-200 {
                --tw-text-opacity: 1 !important;
                color: rgb(75 85 99 / var(--tw-text-opacity, 1)) !important; /* text-gray-600 */
            }
        }
    </style>
    
    <!-- Google Analytics (replace YOUR_MEASUREMENT_ID with actual ID) -->
    <!-- Uncomment when ready to use:
    <script async src="https://www.googletagmanager.com/gtag/js?id=YOUR_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'YOUR_MEASUREMENT_ID');
    </script>
    -->
    
    <!-- Google Search Console verification (add your verification meta tag here) -->
    <!-- <meta name="google-site-verification" content="YOUR_VERIFICATION_CODE" /> -->
    
    {% block head %}{% endblock %}
</head>
<body class="font-mono bg-gray-100 dark:bg-gray-950 text-gray-900 dark:text-green-400 min-h-screen transition-colors duration-300">
    <!-- Theme initialization script - runs immediately -->
    <script>
        // Initialize theme immediately to prevent flash
        (function() {
            const theme = localStorage.getItem('theme');
            const isDark = theme === 'dark';
            
            if (isDark) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        })();
        
        // Alpine.js theme manager
        document.addEventListener('alpine:init', () => {
            Alpine.data('themeManager', () => ({
                isDark: localStorage.getItem('theme') === 'dark',
                
                init() {
                    this.$watch('isDark', value => {
                        localStorage.setItem('theme', value ? 'dark' : 'light');
                        if (value) {
                            document.documentElement.classList.add('dark');
                        } else {
                            document.documentElement.classList.remove('dark');
                        }
                    });
                },
                
                toggleTheme() {
                    this.isDark = !this.isDark;
                }
            }));
        });
    </script>
    
    {% block content %}{% endblock %}
</body>
</html>